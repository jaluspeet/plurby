@model Plurby.Services.Shared.UsersIndexDTO
@{
    ViewData["Title"] = "Gestione Dipendenti";
}

<div class="container mt-4">
     <div class="d-flex justify-content-between align-items-center mb-4">
         <h1 class="mb-0">Gestione Dipendenti</h1>
     </div>

    <div class="table-responsive">
        <table class="table table-striped table-hover" style="background-color: #D9D9D9;">
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>Email</th>
                    <th>Stato</th>
                    <th>Azioni</th>
                </tr>
            </thead>
            <tbody id="userTableBody">
                @foreach (var user in Model.Users)
                {
                    <tr class="userRow">
                        <td>@user.FirstName @user.LastName</td>
                        <td>@user.Email</td>
                        <td>
                            @if (user.IsWorking)
                            {
                                <span class="badge bg-success rounded-pill">Lavorando</span>
                            }
                            else
                            {
                                <span class="badge bg-danger rounded-pill">Non Lavorando</span>
                            }
                        </td>
                        <td>
                            <a asp-action="EmployeeDetail" asp-route-id="@user.Id" class="btn btn-sm" style="background-color: #FF8D28; color: white;">
                                <i class="fas fa-history"></i>
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Contatore e pulsanti -->
     <div class="d-flex justify-content-between align-items-center mt-4">
         <!-- Contatore pagina -->
         <div id="pageCounter" class="fw-bold"></div>

         <!-- Pulsanti navigazione -->
         <div class="d-flex gap-2">
             <button id="prevBtn" class="btn d-flex align-items-center py-2 px-3" style="background: none; border: none; color: #FF7700; text-decoration: underline;">
                 <i class="fas fa-arrow-left me-2"></i> Indietro
             </button>
             <button id="nextBtn" class="btn d-flex align-items-center py-2 px-3" style="background-color: #0B6E4F; color: white; border-radius: 20px;">
                 Avanti <i class="fas fa-arrow-right ms-2"></i>
             </button>
         </div>
     </div>
</div>

<!-- FontAwesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<!-- Script per la paginazione -->
<script>
    const rows = document.querySelectorAll('.userRow');
    const rowsPerPage = 3;
    let currentPage = 1;
    const totalPages = Math.ceil(rows.length / rowsPerPage);

    const pageCounter = document.getElementById('pageCounter');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    function showPage(page) {
        const start = (page - 1) * rowsPerPage;
        const end = start + rowsPerPage;

        rows.forEach((row, index) => {
            row.style.display = (index >= start && index < end) ? '' : 'none';
        });

        prevBtn.disabled = page === 1;
        nextBtn.disabled = page === totalPages;

        // Aggiorna contatore pagina
        pageCounter.textContent = `${currentPage} / ${totalPages}`;
    }

    prevBtn.addEventListener('click', () => {
        if (currentPage > 1) {
            currentPage--;
            showPage(currentPage);
        }
    });

    nextBtn.addEventListener('click', () => {
        if (currentPage < totalPages) {
            currentPage++;
            showPage(currentPage);
        }
    });

    // Mostra la prima pagina inizialmente
    showPage(currentPage);
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
